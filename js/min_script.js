var buy_links = document.querySelectorAll(".card__button--buy"), purchase = document.querySelector(".modal--purchase"), close_purchase = purchase.querySelector(".modal__close-button"); buy_links.forEach(function (e) { e.addEventListener("click", function (e) { e.preventDefault(), purchase.classList.add("modal__show") }) }), close_purchase.addEventListener("click", function (e) { e.preventDefault(), purchase.classList.remove("modal__show") }), window.addEventListener("keydown", function (e) { 27 === e.keyCode && (e.preventDefault(), purchase.classList.contains("modal__show") && purchase.classList.remove("modal__show")) }); var popup_letter = document.querySelector(".modal--letter"), write_us = document.querySelector(".button--letter"), close_letter = popup_letter.querySelector(".modal__close-button"), user_name = popup_letter.querySelector("[name=username]"), form = popup_letter.querySelector("form"), user_mail = popup_letter.querySelector("[name=usermail]"), text = popup_letter.querySelector("[name=usertext]"), is_storage_support = !0, storage_name = "", storage_mail = ""; try { storage_name = localStorage.getItem("username"), storage_mail = localStorage.getItem("usermail") } catch (e) { is_storage_support = !1 } write_us.addEventListener("click", function (e) { e.preventDefault(), popup_letter.classList.add("modal__show"), storage_name && storage_mail ? (user_name.value = storage_name, user_mail.value = storage_mail, text.focus()) : !storage_name && storage_mail ? (user_mail.value = storage_mail, user_name.focus()) : storage_name && !storage_mail && user_mail.focus() }), close_letter.addEventListener("click", function (e) { e.preventDefault(), popup_letter.classList.remove("modal__show"), popup_letter.classList.remove("modal__error") }), form.addEventListener("submit", function (e) { user_name.value && user_mail.value && text.value ? (is_storage_support && (localStorage.setItem("username", user_name.value), localStorage.setItem("usermail", user_mail.value)), form.submit()) : (e.preventDefault(), popup_letter.classList.remove("modal__error"), popup_letter.offsetWidth = popup_letter.offsetWidth, popup_letter.classList.add("modal__error"), console.log("Введите имя и адрес")) }), window.addEventListener("keydown", function (e) { 27 === e.keyCode && (e.preventDefault(), popup_letter.classList.contains("modal__show") && (popup_letter.classList.remove("modal__show"), popup_letter.classList.remove("modal__error"))) }); var map = document.querySelector(".modal--map"), map_link = document.querySelector(".info__map"), close_map = map.querySelector(".modal__close-button"); map_link.addEventListener("click", function (e) { e.preventDefault(), map.classList.add("modal__show") }), close_map.addEventListener("click", function (e) { e.preventDefault(), map.classList.remove("modal__show") }), window.addEventListener("keydown", function (e) { 27 === e.keyCode && (e.preventDefault(), map.classList.contains("modal__show") && map.classList.remove("modal__show")) });